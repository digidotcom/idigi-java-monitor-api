<html>
  <head>
    <title>iDigi Push Monitor Netty Implementation</title>
  </head>
  <body>
    <h1>iDigi Push Monitor Netty Implementation</h1>
<p>This project contains an implementation of the iDigi Push Monitor API using the
Netty network application library. There are two service implementations in this
module:</p>
<ul>
<li><code>com.idigi.monitor.netty.NettyMonitorService</code> </li>
<li><code>com.idigi.monitor.netty.SecureNettyMonitorService</code></li>
</ul>
<h2>NettyMonitorService</h2>
<p>The <code>NettyMonitorService</code> is an insecure implementation of the monitor service
API. All data exchanged by this service (including credentials) is sent
unencrypted over the wire. It is not recommeded to use this service in
production environments.</p>
<h3>Example: Create a netty monitor service</h3>
<pre><code>MonitorService service = new NettyMonitorService('developer.idigi.com', 'username', 'password'); 
  PublishMessageListener listener = new PublishMessageListener {
  @Override
  public void publishMessageReceived(PublishMessage message) {
    Scanner scanner = new Scanner(message.getPayload());
    while(scanner.hasNextLine()) {
      System.out.println(scanner.nextLine());
    }
  }
}
MonitorClientContext client = service.buildClient(1234, listener);
client.start();
</code></pre>
<p>It is also possible to create a service from a <code>NettyMonitorContext</code> POJO. This 
is useful if your application uses a dependency injection framework to determine
the service context.</p>
<h3>Example: Create a netty monitor service from a context</h3>
<pre><code>Authentication auth = new Authentication('user', 'pass');
NettyMonitorContext context = new NettyMonitorContext('developer.idigi.com', auth);
MonitorService service = new NettyMonitorService(context);
PublishMessageListener listener = new PublishMessageListener {
  @Override
  public void publishMessageReceived(PublishMessage message) {
    Scanner scanner = new Scanner(message.getPayload());
    while(scanner.hasNextLine()) {
      System.out.println(scanner.nextLine());
    }
  }
}
MonitorClientContext client = service.buildClient(1234, listener);
client.start();
</code></pre>
<h2>SecureNettyMonitorService</h2>
<p>The <code>SecureNettyMonitorService</code> is a secure implementation of the monitor
service API. All data exchanged by this service is send over SSL.</p>
<h3>Example: Create a secure netty monitor service</h3>
<pre><code>MonitorService service = new SecureNettyMonitorService('developer.idigi.com', 'username', 'password'); 
PublishMessageListener listener = new PublishMessageListener {
  @Override
  public void publishMessageReceived(PublishMessage message) {
    Scanner scanner = new Scanner(message.getPayload());
    while(scanner.hasNextLine()) {
      System.out.println(scanner.nextLine());
    }
  }
}
MonitorClientContext client = service.buildClient(1234, listener);
client.start();
</code></pre>
<p>By default, the <code>SecureNettyMonitorService</code> accepts all certificates which
makes it vulnerable to man-in-the-middle attacks. This can be avoided by
providing a custom <code>SSLContext</code> object via a <code>SecureNettyMonitorContext</code>.</p>
<h3>Example: Using a custom SSL context</h3>
<pre><code>SSLContext sslContext = ...; // some custom SSLContext
Authentication auth = new Authentication('user', 'pass');
SecureNettyMonitorContext context = new SecureNettyMonitorContext('developer.idigi.com', auth, sslContext);
MonitorService service = new SecureNettyMonitorService(context); 
PublishMessageListener listener = new PublishMessageListener {
  {@literal @Override}
  public void publishMessageReceived(PublishMessage message) {
    Scanner scanner = new Scanner(message.getPayload());
    while(scanner.hasNextLine()) {
      System.out.println(scanner.nextLine());
    }
  }
}
MonitorClientContext client = service.buildClient(1234, listener);
client.start();
</code></pre>
</body></html>
